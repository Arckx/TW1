!function(c){window.llms=window.llms||{},window.llms.metabox_product=function(){this.$plans=null,this.$save=null,this.temp_id=Math.floor(7777*Math.random()+777),this.validation_class="llms-invalid",this.init=function(e){var t=this;t.$plans=c("#llms-access-plans"),t.$save=c("#llms-save-access-plans"),t.bind_visibility();var a=c("#lifterlms-product #llms-product-options-access-plans");if(a.length)if(e)t.bind();else{LLMS.Spinner.start(a);var l,s=0;l=setInterval(function(){if(300<=s)a.html(LLMS.l10n.translate("There was an error loading the necessary resources. Please try again."));else{if("undefined"==typeof tinyMCE)return void s++;t.bind()}clearInterval(l),LLMS.Spinner.stop(a)},100)}},this.bind=function(){var s=this;setTimeout(function(){s.has_plan_limit_been_reached()&&s.toggle_create_button("disable")},500),0===s.get_current_plan_count()&&s.toggle_save_button("disable"),s.$save.on("click",function(e){e.preventDefault(),s.save_plans()}),s.$plans.on("change","[data-controller-id]",function(){s.controller_change(c(this))}),s.$plans.on("change",'select[name$="[availability]"]',function(){var e=c(this).closest(".llms-access-plan"),t=e.find('input[name$="[checkout_redirect_forced]"]'),a=e.find(".llms-checkout-redirect-settings");"members"===c(this).val()?(t.prop("checked")?a.show():a.hide(),t.on("change",function(){a.toggle()})):(t.off("change"),a.show())}),c("#llms-access-plans .llms-access-plan-datepicker").datepicker({dateFormat:"mm/dd/yy"}),c("#llms-access-plans [data-controller-id]").trigger("change"),c("#llms-new-access-plan").on("click",function(){s.init_plan(),s.toggle_create_button("disable"),s.toggle_save_button("enable"),setTimeout(function(){s.has_plan_limit_been_reached()||s.toggle_create_button("enable")},500)}),s.$plans.sortable({handle:".llms-drag-handle",items:".llms-access-plan",start:function(e,t){s.$plans.addClass("dragging")},stop:function(e,t){s.$plans.removeClass("dragging"),s.update_plan_orders()}}),s.$plans.on("keyup","input.llms-plan-title",function(){var e=c(this),t=e.closest(".llms-access-plan").find("span.llms-plan-title"),a=e.val(),l=a||t.attr("data-default");t.text(l)}),s.$plans.on("focusin","input",function(e,t){c(this).addClass("llms-has-been-focused")}),s.$plans.on("keyup focusout llms-validate-plan-field","input",function(e,t){var a=c(this);a[0].checkValidity()?a.removeClass(s.validation_class):(a.addClass(s.validation_class),"keyup"===e.type&&a[0].reportValidity()),t&&!t.cascade||a.closest(".llms-access-plan").trigger("llms-validate-plan",{original_event:e.type})}),s.$plans.on("llms-validate-plan",".llms-access-plan",function(e,t){t=t||{};var a=c(this),l=t.original_event?"input.llms-has-been-focused":"input";a.find(l).each(function(){c(this).trigger("llms-validate-plan-field",{cascade:!1})}),a.find("."+s.validation_class).length?a.addClass(s.validation_class):a.removeClass(s.validation_class)}),s.$plans.on("llms-collapsible-toggled",".llms-access-plan",function(){var e=c(this);e.hasClass("opened")&&setTimeout(function(){e.find("input.llms-invalid").each(function(){c(this)[0].reportValidity()})},500)}),s.$plans.on("click",".llms-plan-delete",function(e){e.stopPropagation(),s.delete_plan(c(this))}),window.llms.metaboxes.post_select(c("#llms-access-plans .llms-availability-restrictions")),window.llms.metaboxes.post_select(c("#llms-access-plans .llms-checkout-redirect-page")),c("#_llms_plans_content_llms-new-access-plan-model").attr("disabled","disabled"),tinyMCE.EditorManager.execCommand("mceRemoveEditor",!0,"_llms_plans_content_llms-new-access-plan-model")},this.bind_visibility=function(){var t=c("#llms-catalog-visibility-select"),a=c("a.llms-edit-catalog-visibility"),e=c("a.llms-save-catalog-visibility"),l=c("a.llms-cancel-catalog-visibility");a.on("click",function(e){e.preventDefault(),t.slideDown("fast"),a.hide()}),e.on("click",function(e){e.preventDefault(),t.slideUp("fast"),a.show(),c("#llms-catalog-visibility-display").text(c('input[name="_llms_visibility"]:checked').attr("data-label"))}),l.on("click",function(e){e.preventDefault(),t.slideUp("fast"),a.show()})},this.delete_plan=function(e){var t=this,a=e.closest(".llms-access-plan"),l=a.attr("data-id"),s=LLMS.l10n.translate("After deleting this access plan, any students subscribed to this plan will still have access and will continue to make recurring payments according to the access plan's settings. If you wish to terminate their plans you must do so manually. This action cannot be reversed.");l?window.confirm(s)&&(LLMS.Spinner.start(a),window.LLMS.Ajax.call({data:{action:"delete_access_plan",plan_id:l},success:function(e){setTimeout(function(){LLMS.Spinner.stop(a)},550),e.success?(t.remove_plan_el(a),t.trigger_update_hook(),setTimeout(function(){t.update_plan_orders()},500)):e.message&&alert(e.message)}})):t.remove_plan_el(a)},this.controller_change=function(e){var t=e.attr("data-controller-id"),i=e.val(),a=e.closest(".llms-access-plan").find('[data-controller="'+t+'"]');"checkbox"===e.attr("type")&&(i=e.is(":checked")?i:"no"),a.each(function(){var e,t,a=c(this),l="SELECT"===a[0].nodeName||"INPUT"===a[0].nodeName||"TEXTAREA"===a[0].nodeName?a:a.find("input, select, textarea"),s=a.attr("data-value-is"),n=a.attr("data-value-is-not");switch(void 0!==s&&!1!==s?t="==":void 0!==n&&!1!==n&&(t="!="),t){case"==":e=i==s?"show":"hide";break;case"!=":e=i!=n?"show":"hide"}"show"===e?(a.show(),l.removeAttr("disabled").trigger("change")):"hide"===e&&(a.hide(),l.attr("disabled","disabled"))})},this.get_current_plan_count=function(){return this.$plans.find(".llms-access-plan").length},this.get_plans_array=function(){tinyMCE.triggerSave();for(var e=this.$plans.closest("form").serializeArray(),t=[],a=0;a<e.length;a++)if(-1!==e[a].name.indexOf("_llms_plans")){var l=e[a].name.replace("_llms_plans[","").split("]["),s=l[0]-1,n=l[1].replace("]",""),i=3===l.length?"array":"single";t[s]||(t[s]={}),"array"==i?(t[s][n]||(t[s][n]=[]),t[s][n].push(e[a].value)):t[s][n]=e[a].value}return t},this.has_plan_limit_been_reached=function(){var e=window.llms.product.access_plan_limit;return this.get_current_plan_count()>=e},this.init_plan=function(){if(!this.has_plan_limit_been_reached()){var e=c("#llms-new-access-plan-model").clone();$existing_plans=c("#llms-access-plans .llms-access-plan"),$editor=e.find("#_llms_plans_content_llms-new-access-plan-model"),e.removeAttr("id"),$editor.removeAttr("id").attr("id","_llms_plans_content_"+this.temp_id),this.temp_id++,e.find("select, input, textarea").each(function(){c(this).removeAttr("disabled")}),e.find(".llms-access-plan-datepicker").datepicker({dateFormat:"mm/dd/yy"}),e.appendTo("#llms-access-plans"),this.update_plan_orders(),e.find(".llms-collapsible-header").trigger("click"),this.has_plan_limit_been_reached()&&this.toggle_create_button("disable"),window.llms.metaboxes.post_select(e.find(".llms-availability-restrictions")),window.llms.metaboxes.post_select(e.find(".llms-checkout-redirect-page")),e.find("[data-controller-id]").trigger("change"),c(document).trigger("llms-plan-init",e)}},this.save_plans=function(){var t=this;if(t.$plans.find(".llms-access-plan").not("#llms-new-access-plan-model").each(function(){c(this).trigger("llms-validate-plan")}),t.$plans.find("."+t.validation_class).length)return t.$plans.find(".llms-access-plan."+t.validation_class).not(".opened").first().find(".llms-collapsible-header").trigger("click"),void c(document).trigger("llms-access-plan-validation-errors");LLMS.Spinner.start(t.$plans),t.$save.attr("disabled","disabled"),window.LLMS.Ajax.call({data:{action:"llms_update_access_plans",plans:t.get_plans_array()},complete:function(){LLMS.Spinner.stop(t.$plans),t.$save.removeAttr("disabled")},error:function(e,t,a){console.error("llms access plan save error encounterd:",e),alert(LLMS.l10n.translate("An error was encountered during the save attempt. Please try again.")+" ["+t+": "+a+"]")},success:function(e){!e.success&&e.code&&"error"===e.code?alert(e.message):e.data&&e.data.html&&(c("#llms-product-options-access-plans").replaceWith(e.data.html),t.init(!0),window.llms.metaboxes.init(),t.update_plan_orders(),t.trigger_update_hook())}})},this.toggle_button=function(e,t){"disable"===t?e.attr("disabled","disabled"):e.removeAttr("disabled")},this.toggle_create_button=function(e){this.toggle_button(c("#llms-new-access-plan"),e)},this.toggle_save_button=function(e){this.toggle_button(this.$save,e)},this.remove_plan_el=function(e){var t=this;e.fadeOut(400),setTimeout(function(){e.remove(),t.has_plan_limit_been_reached()||t.toggle_create_button("enable"),0===t.get_current_plan_count()&&t.toggle_save_button("disable")},450)},this.trigger_update_hook=function(){c(document).trigger("llms-access-plans-updated")},this.update_plan_orders=function(){c("#llms-access-plans .llms-access-plan").each(function(){var e=c(this),t=e.find(".plan-order"),a=e.find('textarea[id^="_llms_plans_content_"]').attr("id"),l=+t.val(),s=e.index(),n=tinyMCE.EditorManager.get(a),i=n?n.settings:tinyMCE.EditorManager.settings;i.selector="#"+a,tinyMCE.EditorManager.execCommand("mceRemoveEditor",!0,a),e.find("select, input, textarea").each(function(){var e=c(this).attr("name");e&&c(this).attr("name",e.replace(l,s))}),tinyMCE.EditorManager.init(i),t.val(s)})},this.init()};new window.llms.metabox_product}(jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxsbXMtbWV0YWJveC1wcm9kdWN0LmpzIl0sIm5hbWVzIjpbIiQiLCJ3aW5kb3ciLCJsbG1zIiwibWV0YWJveF9wcm9kdWN0IiwidGhpcyIsIiRwbGFucyIsIiRzYXZlIiwidGVtcF9pZCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInZhbGlkYXRpb25fY2xhc3MiLCJpbml0Iiwic2tpcF9kZXBfY2hlY2tzIiwic2VsZiIsImJpbmRfdmlzaWJpbGl0eSIsIiRtYiIsImxlbmd0aCIsImJpbmQiLCJMTE1TIiwiU3Bpbm5lciIsInN0YXJ0IiwiaW50ZXJ2YWwiLCJjb3VudGVyIiwic2V0SW50ZXJ2YWwiLCJodG1sIiwibDEwbiIsInRyYW5zbGF0ZSIsInRpbnlNQ0UiLCJjbGVhckludGVydmFsIiwic3RvcCIsInNldFRpbWVvdXQiLCJoYXNfcGxhbl9saW1pdF9iZWVuX3JlYWNoZWQiLCJ0b2dnbGVfY3JlYXRlX2J1dHRvbiIsImdldF9jdXJyZW50X3BsYW5fY291bnQiLCJ0b2dnbGVfc2F2ZV9idXR0b24iLCJvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInNhdmVfcGxhbnMiLCJjb250cm9sbGVyX2NoYW5nZSIsIiRwbGFuX2NvbnRhaW5lciIsImNsb3Nlc3QiLCIkcGxhbl9yZWRpcmVjdF9mb3JjZWQiLCJmaW5kIiwiJHBsYW5fcmVkaXJlY3Rfc2V0dGluZ3MiLCJ2YWwiLCJwcm9wIiwic2hvdyIsImhpZGUiLCJ0b2dnbGUiLCJvZmYiLCJkYXRlcGlja2VyIiwiZGF0ZUZvcm1hdCIsInRyaWdnZXIiLCJpbml0X3BsYW4iLCJzb3J0YWJsZSIsImhhbmRsZSIsIml0ZW1zIiwiZXZlbnQiLCJ1aSIsImFkZENsYXNzIiwicmVtb3ZlQ2xhc3MiLCJ1cGRhdGVfcGxhbl9vcmRlcnMiLCIkaW5wdXQiLCIkZGlzcGxheSIsInRpdGxlIiwiYXR0ciIsInRleHQiLCJkYXRhIiwiY2hlY2tWYWxpZGl0eSIsInR5cGUiLCJyZXBvcnRWYWxpZGl0eSIsImNhc2NhZGUiLCJvcmlnaW5hbF9ldmVudCIsIiRwbGFuIiwic2VsZWN0b3IiLCJlYWNoIiwiaGFzQ2xhc3MiLCJzdG9wUHJvcGFnYXRpb24iLCJkZWxldGVfcGxhbiIsIm1ldGFib3hlcyIsInBvc3Rfc2VsZWN0IiwiRWRpdG9yTWFuYWdlciIsImV4ZWNDb21tYW5kIiwiJHJhZGlvcyIsIiR0b2dnbGUiLCIkY2FuY2VsIiwic2xpZGVEb3duIiwic2xpZGVVcCIsIiRidG4iLCJwbGFuX2lkIiwid2FybmluZyIsImNvbmZpcm0iLCJBamF4IiwiY2FsbCIsImFjdGlvbiIsInN1Y2Nlc3MiLCJyIiwicmVtb3ZlX3BsYW5fZWwiLCJ0cmlnZ2VyX3VwZGF0ZV9ob29rIiwibWVzc2FnZSIsImFsZXJ0IiwiJGVsIiwiaWQiLCIkY29udHJvbHMiLCJpcyIsIm9wZXJhdG9yIiwiJGMiLCIkZWxzIiwibm9kZU5hbWUiLCJlcXVhbHMiLCJub3RfZXF1YWxzIiwicmVtb3ZlQXR0ciIsImdldF9wbGFuc19hcnJheSIsInRyaWdnZXJTYXZlIiwiZm9ybSIsInNlcmlhbGl6ZUFycmF5IiwicGxhbnMiLCJpIiwibmFtZSIsImluZGV4T2YiLCJrZXlzIiwicmVwbGFjZSIsInNwbGl0IiwiaW5kZXgiLCJwdXNoIiwidmFsdWUiLCJsaW1pdCIsInByb2R1Y3QiLCJhY2Nlc3NfcGxhbl9saW1pdCIsIiRjbG9uZSIsImNsb25lIiwiJGV4aXN0aW5nX3BsYW5zIiwiJGVkaXRvciIsImFwcGVuZFRvIiwiZG9jdW1lbnQiLCJub3QiLCJmaXJzdCIsImNvbXBsZXRlIiwiZXJyb3IiLCJqcVhIUiIsInRleHRTdGF0dXMiLCJlcnJvclRocm93biIsImNvbnNvbGUiLCJyZXMiLCJjb2RlIiwicmVwbGFjZVdpdGgiLCJ0b2dnbGVfYnV0dG9uIiwic3RhdHVzIiwiZmFkZU91dCIsInJlbW92ZSIsIiRwIiwiJG9yZGVyIiwiZWRpdG9yX2lkIiwib3JpZyIsImN1cnIiLCJlZGl0b3IiLCJnZXQiLCJlc2V0dGluZ3MiLCJzZXR0aW5ncyIsImpRdWVyeSJdLCJtYXBw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QVNnQyxFQUFNQyxNQVE5Q2hJLFFBQVF1RCxjQUFjdkUsS0FBTW1KLEdBRTVCTixFQUFPM0csSUFBSzhHLE1BT2R4SixLQUFLUSxRQUlFLElBQUlYLE9BQU9DLEtBQUtDLGdCQTl3QnpCLENBZ3hCSzhKIiwiZmlsZSI6ImxsbXMtbWV0YWJveC1wcm9kdWN0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUHJvZHVjdCBPcHRpb25zIE1ldGFCb3hcbiAqIERpc3BsYXlzIG9uIENvdXJzZSAmIE1lbWJlcnNoaXAgUG9zdCBUeXBlc1xuICpcbiAqIEBzaW5jZSAzLjAuMFxuICogQHNpbmNlIDMuMzAuMyBVbmtub3duLlxuICogQHNpbmNlIDMuMzYuMyBGaXhlZCBjb25mbGljdHMgd2l0aCB0aGUgQ2xhc3NpYyBFZGl0b3IgYmxvY2suXG4gKiBAdmVyc2lvbiAzLjM2LjNcbiAqL1xuKCBmdW5jdGlvbiggJCApIHtcblxuXHR3aW5kb3cubGxtcyA9IHdpbmRvdy5sbG1zIHx8IHt9O1xuXG5cdHdpbmRvdy5sbG1zLm1ldGFib3hfcHJvZHVjdCA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0LyoqXG5cdFx0ICogalF1ZXJ5IG9iaiBmb3IgdGhlIG1haW4gJCggJyNsbG1zLWFjY2Vzcy1wbGFucycgKSBlbGVtZW50LlxuXHRcdCAqXG5cdFx0ICogQHR5cGUgb2JqXG5cdFx0ICovXG5cdFx0dGhpcy4kcGxhbnMgPSBudWxsO1xuXG5cdFx0LyoqXG5cdFx0ICogalF1ZXJ5IG9iaiBmb3IgdGhlIG1haW4gJCggJyNsbG1zLXNhdmUtYWNjZXNzLXBsYW5zJyApIHNhdmUgYnV0dG9uIGVsZW1lbnQuXG5cdFx0ICpcblx0XHQgKiBAdHlwZSBvYmpcblx0XHQgKi9cblx0XHR0aGlzLiRzYXZlID0gbnVsbDtcblxuXHRcdC8qKlxuXHRcdCAqIEEgcmFuZG9tbHkgZ2VuZXJhdGVkIHRlbXBvcmFyeSBJRCB1c2VkIGZvciB0aGUgdGlueU1DRSBlZGl0b3IncyBpZFxuXHRcdCAqIHdoZW4gYSBuZXcgcGxhbiBpcyBhZGRlZFxuXHRcdCAqXG5cdFx0ICogQHR5cGUgaW50XG5cdFx0ICovXG5cdFx0dGhpcy50ZW1wX2lkID0gTWF0aC5mbG9vciggKCBNYXRoLnJhbmRvbSgpICogNzc3NyApICsgNzc3ICk7XG5cblx0XHQvKipcblx0XHQgKiBDU1MgY2xhc3MgbmFtZSB1c2VkIHRvIGhpZ2hsaWdodCB2YWxpZGF0aW9uIGVycm9ycyBmb3IgcGxhbiBmaWVsZHNcblx0XHQgKlxuXHRcdCAqIEB0eXBlIHN0cmluZ1xuXHRcdCAqL1xuXHRcdHRoaXMudmFsaWRhdGlvbl9jbGFzcyA9ICdsbG1zLWludmFsaWQnO1xuXG5cdFx0LyoqXG5cdFx0ICogSW5pdGlhbGl6ZVxuXHRcdCAqXG5cdFx0ICogQHBhcmFtICAgYm9vbCBza2lwX2RlcF9jaGVja3MgaWYgdHJ1ZSwgc2tpcHMgZGVwZW5kZW5jeSBjaGVja3MuXG5cdFx0ICogQHJldHVybiAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gMy4yOS4zXG5cdFx0ICovXG5cdFx0dGhpcy5pbml0ID0gZnVuY3Rpb24oIHNraXBfZGVwX2NoZWNrcyApIHtcblxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHRzZWxmLiRwbGFucyA9ICQoICcjbGxtcy1hY2Nlc3MtcGxhbnMnICk7XG5cdFx0XHRzZWxmLiRzYXZlICA9ICQoICcjbGxtcy1zYXZlLWFjY2Vzcy1wbGFucycgKTtcblxuXHRcdFx0c2VsZi5iaW5kX3Zpc2liaWxpdHkoKTtcblxuXHRcdFx0dmFyICRtYiA9ICQoICcjbGlmdGVybG1zLXByb2R1Y3QgI2xsbXMtcHJvZHVjdC1vcHRpb25zLWFjY2Vzcy1wbGFucycgKTtcblxuXHRcdFx0aWYgKCAhICRtYi5sZW5ndGggKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH0gZWxzZSBpZiAoIHNraXBfZGVwX2NoZWNrcyApIHtcblx0XHRcdFx0c2VsZi5iaW5kKCk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0TExNUy5TcGlubmVyLnN0YXJ0KCAkbWIgKTtcblxuXHRcdFx0Ly8gd2UgcmVseSBvbiBUaW55TUNFIGJ1dCBXb3JkUHJlc3MgZG9lc24ndCByZWdpc3RlciBUaW55TUNFXG5cdFx0XHQvLyBsaWtlIGV2ZXJ5IG90aGVyIGFkbWluIHNjcmlwdCBzbyB3ZSdsbCBkbyBhIGxpdHRsZSBkZXBlbmRlbmN5IGNoZWNrIGhlcmUuLi5cblx0XHRcdHZhciBjb3VudGVyID0gMCxcblx0XHRcdFx0aW50ZXJ2YWw7XG5cblx0XHRcdGludGVydmFsID0gc2V0SW50ZXJ2YWwoIGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdC8vIGlmIHdlIGdldCB0byAzMCBzZWNvbmRzIGRpc3BsYXkgYW4gZXJyb3IgbWVzc2FnZVxuXHRcdFx0XHRpZiAoIGNvdW50ZXIgPj0gMzAwICkge1xuXG5cdFx0XHRcdFx0JG1iLmh0bWwoIExMTVMubDEwbi50cmFuc2xhdGUoICdUaGVyZSB3YXMgYW4gZXJyb3IgbG9hZGluZyB0aGUgbmVjZXNzYXJ5IHJlc291cmNlcy4gUGxlYXNlIHRyeSBhZ2Fpbi4nICkgKTtcblxuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIGlmIHdlIGNhbid0IGFjY2VzcyB0aW55TUNFLCBpbmNyZW1lbnQgYW5kIHdhaXQuLi5cblx0XHRcdFx0ZWxzZSBpZiAoICd1bmRlZmluZWQnID09PSB0eXBlb2YgdGlueU1DRSApIHtcblxuXHRcdFx0XHRcdGNvdW50ZXIrKztcblx0XHRcdFx0XHRyZXR1cm47XG5cblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBiaW5kIHRoZSBldmVudHMsIHdlJ3JlIGdvb2QhXG5cdFx0XHRcdGVsc2Uge1xuXG5cdFx0XHRcdFx0c2VsZi5iaW5kKCk7XG5cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNsZWFySW50ZXJ2YWwoIGludGVydmFsICk7XG5cdFx0XHRcdExMTVMuU3Bpbm5lci5zdG9wKCAkbWIgKTtcblxuXHRcdFx0fSwgMTAwICk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogQmluZCBET00gRXZlbnRzXG5cdFx0ICpcblx0XHQgKiBAc2luY2UgIDMuMC4wXG5cdFx0ICogQHNpbmNlICAzLjMwLjAgQWRkIGNoZWNrb3V0IHJlZGlyZWN0IGZpZWxkcyBldmVudHMuXG5cdFx0ICogQHZlcnNpb24gMy4zMC4wXG5cdFx0ICpcblx0XHQgKiBAcmV0dXJuIHZvaWRcblx0XHQgKi9cblx0XHR0aGlzLmJpbmQgPSBmdW5jdGlvbigpIHtcblxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHRzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCBzZWxmLmhhc19wbGFuX2xpbWl0X2JlZW5fcmVhY2hlZCgpICkge1xuXHRcdFx0XHRcdHNlbGYudG9nZ2xlX2NyZWF0ZV9idXR0b24oICdkaXNhYmxlJyApO1xuXHRcdFx0XHR9XG5cdFx0XHR9LCA1MDAgKTtcblxuXHRcdFx0aWYgKCAwID09PSBzZWxmLmdldF9jdXJyZW50X3BsYW5fY291bnQoKSApIHtcblx0XHRcdFx0c2VsZi50b2dnbGVfc2F2ZV9idXR0b24oICdkaXNhYmxlJyApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBzYXZlIGFjY2VzcyBwbGFucyBidXR0b24uXG5cdFx0XHRzZWxmLiRzYXZlLm9uKCAnY2xpY2snLCBmdW5jdGlvbiggZSApIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRzZWxmLnNhdmVfcGxhbnMoKTtcblx0XHRcdH0gKTtcblxuXHRcdFx0Ly8gYmluZCBjaGFuZ2UgZXZlbnRzIHRvIGZvcm0gZWxlbWVudCB0aGF0IGNvbnRyb2xzIGFub3RoZXIgZm9ybSBlbGVtZW50XG5cdFx0XHRzZWxmLiRwbGFucy5vbiggJ2NoYW5nZScsICdbZGF0YS1jb250cm9sbGVyLWlkXScsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRzZWxmLmNvbnRyb2xsZXJfY2hhbmdlKCAkKCB0aGlzICkgKTtcblx0XHRcdH0gKTtcblxuXHRcdFx0Ly8gQHRvZG8gUmVwbGFjZSB0aGlzIHdpdGggbXVsdGlwbGUgZGF0YS1jb250cm9sbGVyIGZ1bmN0aW9uYWxpdHkgaW4gbGxtcy1tZXRhYm94ZXMuanNcblx0XHRcdHNlbGYuJHBsYW5zLm9uKCAnY2hhbmdlJywgJ3NlbGVjdFtuYW1lJD1cIlthdmFpbGFiaWxpdHldXCJdJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciAkcGxhbl9jb250YWluZXIgICAgICAgICA9ICQoIHRoaXMgKS5jbG9zZXN0KCAnLmxsbXMtYWNjZXNzLXBsYW4nICksXG5cdFx0XHRcdFx0JHBsYW5fcmVkaXJlY3RfZm9yY2VkICAgPSAkcGxhbl9jb250YWluZXIuZmluZCggJ2lucHV0W25hbWUkPVwiW2NoZWNrb3V0X3JlZGlyZWN0X2ZvcmNlZF1cIl0nICksXG5cdFx0XHRcdFx0JHBsYW5fcmVkaXJlY3Rfc2V0dGluZ3MgPSAkcGxhbl9jb250YWluZXIuZmluZCggJy5sbG1zLWNoZWNrb3V0LXJlZGlyZWN0LXNldHRpbmdzJyApO1xuXG5cdFx0XHRcdGlmICggJ21lbWJlcnMnID09PSAkKCB0aGlzICkudmFsKCkgKSB7XG5cdFx0XHRcdFx0aWYgKCAhICRwbGFuX3JlZGlyZWN0X2ZvcmNlZC5wcm9wKCAnY2hlY2tlZCcgKSApIHtcblx0XHRcdFx0XHRcdCRwbGFuX3JlZGlyZWN0X3NldHRpbmdzLmhpZGUoKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0JHBsYW5fcmVkaXJlY3Rfc2V0dGluZ3Muc2hvdygpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdCRwbGFuX3JlZGlyZWN0X2ZvcmNlZC5vbiggJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0JHBsYW5fcmVkaXJlY3Rfc2V0dGluZ3MudG9nZ2xlKCk7XG5cdFx0XHRcdFx0fSApO1xuXG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0JHBsYW5fcmVkaXJlY3RfZm9yY2VkLm9mZiggJ2NoYW5nZScgKTtcblx0XHRcdFx0XHQkcGxhbl9yZWRpcmVjdF9zZXR0aW5ncy5zaG93KCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0fSApO1xuXG5cdFx0XHQkKCAnI2xsbXMtYWNjZXNzLXBsYW5zIC5sbG1zLWFjY2Vzcy1wbGFuLWRhdGVwaWNrZXInICkuZGF0ZXBpY2tlcigge1xuXHRcdFx0XHRkYXRlRm9ybWF0OiBcIm1tL2RkL3l5XCJcblx0XHRcdH0gKTtcblxuXHRcdFx0Ly8gdHJpZ2dlciBjaGFuZ2VzIG9uIGxvYWQgZm9yIGFsbCBleGlzdGluZyBwbGFuc1xuXHRcdFx0JCggJyNsbG1zLWFjY2Vzcy1wbGFucyBbZGF0YS1jb250cm9sbGVyLWlkXScgKS50cmlnZ2VyKCAnY2hhbmdlJyApO1xuXG5cdFx0XHQvLyBhZGQgYSBuZXcgZW1wdHkgcGxhbiBpbnRlcmZhY2Ugb24gbmV3IHBsYW4gYnV0dG9uIGNsaWNrLlxuXHRcdFx0JCggJyNsbG1zLW5ldy1hY2Nlc3MtcGxhbicgKS5vbiggJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHNlbGYuaW5pdF9wbGFuKCk7XG5cdFx0XHRcdHNlbGYudG9nZ2xlX2NyZWF0ZV9idXR0b24oICdkaXNhYmxlJyApO1xuXHRcdFx0XHRzZWxmLnRvZ2dsZV9zYXZlX2J1dHRvbiggJ2VuYWJsZScgKTtcblx0XHRcdFx0c2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0aWYgKCAhIHNlbGYuaGFzX3BsYW5fbGltaXRfYmVlbl9yZWFjaGVkKCkgKSB7XG5cdFx0XHRcdFx0XHRzZWxmLnRvZ2dsZV9jcmVhdGVfYnV0dG9uKCAnZW5hYmxlJyApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSwgNTAwICk7XG5cdFx0XHR9ICk7XG5cblx0XHRcdHNlbGYuJHBsYW5zLnNvcnRhYmxlKCB7XG5cdFx0XHRcdGhhbmRsZTogJy5sbG1zLWRyYWctaGFuZGxlJyxcblx0XHRcdFx0aXRlbXM6ICcubGxtcy1hY2Nlc3MtcGxhbicsXG5cdFx0XHRcdHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpICkge1xuXHRcdFx0XHRcdHNlbGYuJHBsYW5zLmFkZENsYXNzKCAnZHJhZ2dpbmcnICk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdHN0b3A6IGZ1bmN0aW9uKCBldmVudCwgdWkgKSB7XG5cdFx0XHRcdFx0c2VsZi4kcGxhbnMucmVtb3ZlQ2xhc3MoICdkcmFnZ2luZycgKTtcblx0XHRcdFx0XHRzZWxmLnVwZGF0ZV9wbGFuX29yZGVycygpO1xuXHRcdFx0XHR9LFxuXHRcdFx0fSApO1xuXG5cdFx0XHQvLyBiaW5kIHRleHQgZW50ZXJlZCBpbnRvIHRoZSB0aXRsZSB0byB0aGUgZGlzcGxheWVkIHRpdGxlIGZvciBmYW5jeSBmdW5cblx0XHRcdHNlbGYuJHBsYW5zLm9uKCAna2V5dXAnLCAnaW5wdXQubGxtcy1wbGFuLXRpdGxlJywgZnVuY3Rpb24oICkge1xuXG5cdFx0XHRcdHZhciAkaW5wdXQgICA9ICQoIHRoaXMgKSxcblx0XHRcdFx0XHQkcGxhbiAgICA9ICRpbnB1dC5jbG9zZXN0KCAnLmxsbXMtYWNjZXNzLXBsYW4nICksXG5cdFx0XHRcdFx0JGRpc3BsYXkgPSAkcGxhbi5maW5kKCAnc3Bhbi5sbG1zLXBsYW4tdGl0bGUnICksXG5cdFx0XHRcdFx0dmFsICAgICAgPSAkaW5wdXQudmFsKCksXG5cdFx0XHRcdFx0dGl0bGUgICAgPSAoIHZhbCApID8gdmFsIDogJGRpc3BsYXkuYXR0ciggJ2RhdGEtZGVmYXVsdCcgKTtcblxuXHRcdFx0XHQkZGlzcGxheS50ZXh0KCB0aXRsZSApO1xuXG5cdFx0XHR9ICk7XG5cblx0XHRcdC8vIFJlY29yZCB0aGF0IGEgZmllbGQgaGFzIGJlZW4gZm9jdXNlZCBzbyB3ZSBjYW4gdHdlYWsgdmFsaWRhdGlvbiB0byBvbmx5IHZhbGlkYXRlIFwiZWRpdGVkXCIgZmllbGRzLlxuXHRcdFx0c2VsZi4kcGxhbnMub24oICdmb2N1c2luJywgJ2lucHV0JywgZnVuY3Rpb24oIGUsIGRhdGEgKSB7XG5cdFx0XHRcdCQoIHRoaXMgKS5hZGRDbGFzcyggJ2xsbXMtaGFzLWJlZW4tZm9jdXNlZCcgKTtcblx0XHRcdH0gKTtcblxuXHRcdFx0Ly8gVmFsaWRhdGUgYSBzaW5nbGUgaW5wdXQgZmllbGRcblx0XHRcdHNlbGYuJHBsYW5zLm9uKCAna2V5dXAgZm9jdXNvdXQgbGxtcy12YWxpZGF0ZS1wbGFuLWZpZWxkJywgJ2lucHV0JywgZnVuY3Rpb24oIGUsIGRhdGEgKSB7XG5cblx0XHRcdFx0dmFyICRpbnB1dCA9ICQoIHRoaXMgKTtcblxuXHRcdFx0XHRpZiAoICRpbnB1dFswXS5jaGVja1ZhbGlkaXR5KCkgKSB7XG5cdFx0XHRcdFx0JGlucHV0LnJlbW92ZUNsYXNzKCBzZWxmLnZhbGlkYXRpb25fY2xhc3MgKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQkaW5wdXQuYWRkQ2xhc3MoIHNlbGYudmFsaWRhdGlvbl9jbGFzcyApO1xuXHRcdFx0XHRcdGlmICggJ2tleXVwJyA9PT0gZS50eXBlICkge1xuXHRcdFx0XHRcdFx0JGlucHV0WzBdLnJlcG9ydFZhbGlkaXR5KCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKCAhIGRhdGEgfHwgZGF0YS5jYXNjYWRlICkge1xuXHRcdFx0XHRcdCRpbnB1dC5jbG9zZXN0KCAnLmxsbXMtYWNjZXNzLXBsYW4nICkudHJpZ2dlciggJ2xsbXMtdmFsaWRhdGUtcGxhbicsIHsgb3JpZ2luYWxfZXZlbnQ6IGUudHlwZSB9ICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0fSApO1xuXG5cdFx0XHRzZWxmLiRwbGFucy5vbiggJ2xsbXMtdmFsaWRhdGUtcGxhbicsICcubGxtcy1hY2Nlc3MtcGxhbicsIGZ1bmN0aW9uKCBlLCBkYXRhICkge1xuXG5cdFx0XHRcdGRhdGEgPSBkYXRhIHx8IHt9O1xuXG5cdFx0XHRcdHZhciAkcGxhbiA9ICQoIHRoaXMgKSxcblx0XHRcdFx0XHQvLyBvbmx5IHZhbGlkYXRlIFwiZWRpdGVkXCIgZmllbGRzIGR1cmluZyBjYXNjYWRpbmcgdmFsaWRhdGlvbiBmcm9tIGlucHV0IHZhbGlkYXRpb25zLlxuXHRcdFx0XHRcdHNlbGVjdG9yID0gZGF0YS5vcmlnaW5hbF9ldmVudCA/ICdpbnB1dC5sbG1zLWhhcy1iZWVuLWZvY3VzZWQnIDogJ2lucHV0JztcblxuXHRcdFx0XHQkcGxhbi5maW5kKCBzZWxlY3RvciApLmVhY2goIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdCQoIHRoaXMgKS50cmlnZ2VyKCAnbGxtcy12YWxpZGF0ZS1wbGFuLWZpZWxkJywgeyBjYXNjYWRlOiBmYWxzZSB9ICk7XG5cdFx0XHRcdH0gKTtcblxuXHRcdFx0XHRpZiAoICRwbGFuLmZpbmQoICcuJyArIHNlbGYudmFsaWRhdGlvbl9jbGFzcyApLmxlbmd0aCApIHtcblx0XHRcdFx0XHQkcGxhbi5hZGRDbGFzcyggc2VsZi52YWxpZGF0aW9uX2NsYXNzICk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0JHBsYW4ucmVtb3ZlQ2xhc3MoIHNlbGYudmFsaWRhdGlvbl9jbGFzcyApO1xuXHRcdFx0XHR9XG5cblx0XHRcdH0gKTtcblxuXHRcdFx0c2VsZi4kcGxhbnMub24oICdsbG1zLWNvbGxhcHNpYmxlLXRvZ2dsZWQnLCAnLmxsbXMtYWNjZXNzLXBsYW4nLCBmdW5jdGlvbigpIHtcblxuXHRcdFx0XHR2YXIgJHBsYW4gPSAkKCB0aGlzICk7XG5cblx0XHRcdFx0aWYgKCAkcGxhbi5oYXNDbGFzcyggJ29wZW5lZCcgKSApIHtcblx0XHRcdFx0XHQvLyB3YWl0IGZvciBhbmltYXRpb24gdG8gY29tcGxldGUgdG8gcHJldmVudCBmb2N1c2FibGUgZXJyb3JzIGluIHRoZSBjb25zb2xlLlxuXHRcdFx0XHRcdHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0JHBsYW4uZmluZCggJ2lucHV0LmxsbXMtaW52YWxpZCcgKS5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0JCggdGhpcyApWzBdLnJlcG9ydFZhbGlkaXR5KCk7XG5cdFx0XHRcdFx0XHR9ICk7XG5cdFx0XHRcdFx0fSwgNTAwICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0fSApO1xuXG5cdFx0XHRzZWxmLiRwbGFucy5vbiggJ2NsaWNrJywgJy5sbG1zLXBsYW4tZGVsZXRlJywgZnVuY3Rpb24oIGUgKSB7XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdHNlbGYuZGVsZXRlX3BsYW4oICQoIHRoaXMgKSApO1xuXHRcdFx0fSApO1xuXG5cdFx0XHQvLyBzZWxlY3QyaWZ5IG1lbWJlcnNoaXAgYXZhaWxhYmlsaXR5IGZpZWxkc1xuXHRcdFx0d2luZG93LmxsbXMubWV0YWJveGVzLnBvc3Rfc2VsZWN0KCAkKCAnI2xsbXMtYWNjZXNzLXBsYW5zIC5sbG1zLWF2YWlsYWJpbGl0eS1yZXN0cmljdGlvbnMnICkgKTtcblxuXHRcdFx0Ly8gc2VsZWN0MmlmeSByZWRpcmVjdGlvbiBwYWdlIGZpZWxkc1xuXHRcdFx0d2luZG93LmxsbXMubWV0YWJveGVzLnBvc3Rfc2VsZWN0KCAkKCAnI2xsbXMtYWNjZXNzLXBsYW5zIC5sbG1zLWNoZWNrb3V0LXJlZGlyZWN0LXBhZ2UnICkgKTtcblxuXHRcdFx0Ly8gZGlzYWJsZSB0aGUgdGV4dGFyZWEgZ2VuZXJhdGVkIGJ5IHRoZSB3cF9lZGl0b3IgZnVuY3Rpb25cblx0XHRcdC8vIGNhbid0IGZpZ3VyZSBvdXQgaG93IHRvIGRvIHRoaXMgZHVyaW5nIGluaXRpYWxpemF0aW9uXG5cdFx0XHQkKCAnI19sbG1zX3BsYW5zX2NvbnRlbnRfbGxtcy1uZXctYWNjZXNzLXBsYW4tbW9kZWwnICkuYXR0ciggJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyApO1xuXHRcdFx0dGlueU1DRS5FZGl0b3JNYW5hZ2VyLmV4ZWNDb21tYW5kKCAnbWNlUmVtb3ZlRWRpdG9yJywgdHJ1ZSwgJ19sbG1zX3BsYW5zX2NvbnRlbnRfbGxtcy1uZXctYWNjZXNzLXBsYW4tbW9kZWwnICk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogQmluZCBET00gZXZlbnRzIGZvciBlZGl0aW5nIHByb2R1Y3QgdmlzaWJpbGl0eVxuXHRcdCAqXG5cdFx0ICogQHJldHVybiAgIHZvaWRcblx0XHQgKiBAc2luY2UgICAgMy42LjBcblx0XHQgKiBAdmVyc2lvbiAgMy42LjBcblx0XHQgKi9cblx0XHR0aGlzLmJpbmRfdmlzaWJpbGl0eSA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHR2YXIgJHJhZGlvcyA9ICQoICcjbGxtcy1jYXRhbG9nLXZpc2liaWxpdHktc2VsZWN0JyApLFxuXHRcdFx0XHQkdG9nZ2xlID0gJCggJ2EubGxtcy1lZGl0LWNhdGFsb2ctdmlzaWJpbGl0eScgKSxcblx0XHRcdFx0JHNhdmUgICA9ICQoICdhLmxsbXMtc2F2ZS1jYXRhbG9nLXZpc2liaWxpdHknICksXG5cdFx0XHRcdCRjYW5jZWwgPSAkKCAnYS5sbG1zLWNhbmNlbC1jYXRhbG9nLXZpc2liaWxpdHknICk7XG5cblx0XHRcdCR0b2dnbGUub24oICdjbGljaycsIGZ1bmN0aW9uKCBlICkge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdCRyYWRpb3Muc2xpZGVEb3duKCAnZmFzdCcgKTtcblx0XHRcdFx0JHRvZ2dsZS5oaWRlKCk7XG5cdFx0XHR9ICk7XG5cblx0XHRcdCRzYXZlLm9uKCAnY2xpY2snLCBmdW5jdGlvbiggZSApIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHQkcmFkaW9zLnNsaWRlVXAoICdmYXN0JyApO1xuXHRcdFx0XHQkdG9nZ2xlLnNob3coKTtcblx0XHRcdFx0JCggJyNsbG1zLWNhdGFsb2ctdmlzaWJpbGl0eS1kaXNwbGF5JyApLnRleHQoICQoICdpbnB1dFtuYW1lPVwiX2xsbXNfdmlzaWJpbGl0eVwiXTpjaGVja2VkJyApLmF0dHIoICdkYXRhLWxhYmVsJyApICk7XG5cdFx0XHR9ICk7XG5cblx0XHRcdCRjYW5jZWwub24oICdjbGljaycsIGZ1bmN0aW9uKCBlICkge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdCRyYWRpb3Muc2xpZGVVcCggJ2Zhc3QnICk7XG5cdFx0XHRcdCR0b2dnbGUuc2hvdygpO1xuXHRcdFx0fSApO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIEhhbmRsZSBwaHlzaWNhbCBkZWxldGlvbiBvZiBhIHBsYW4gZWxlbWVudFxuXHRcdCAqIElmIHRoZSBwbGFuIGhhc24ndCBiZSBwZXJzaXN0ZWQgdG8gdGhlIGRhdGFiYXNlIGl0J3MgcmVtb3ZlZCBmcm9tIHRoZSBkb21cblx0XHQgKiBpZiBpdCBhbHJlYWR5IGV4aXN0cyBpbiB0aGUgZGF0YWJhc2UgYSBjb25maXJtIG1vZGFsIGlzIGRpc3BsYXllZFxuXHRcdCAqIHVwb24gY29uZmlybWF0aW9uIEFKQVggY2FsbCB3aWxsIGJlIG1hZGUgdG8gbW92ZSB0aGUgcGxhbiB0byB0aGUgdHJhc2hcblx0XHQgKiBhbmQgdXBvbiBzdWNjZXNzIHRoZSBlbGVtZW50IHdpbGwgYmUgcmVtb3ZlZCBmcm9tIHRoZSBkb21cblx0XHQgKlxuXHRcdCAqIEBwYXJhbSAgb2JqICRidG4galF1ZXJ5IHNlbGVjdG9yIG9mIHRoZSBcIlhcIiBidXR0b24gY2xpY2tlZCB0byBpbml0aWF0ZSBkZWxldGlvblxuXHRcdCAqIEByZXR1cm4gdm9pZFxuXHRcdCAqIEBzaW5jZSAgMy4wLjBcblx0XHQgKiBAdmVyc2lvbiAzLjI5LjFcblx0XHQgKi9cblx0XHR0aGlzLmRlbGV0ZV9wbGFuID0gZnVuY3Rpb24oICRidG4gKSB7XG5cblx0XHRcdHZhciBzZWxmICAgID0gdGhpcyxcblx0XHRcdFx0JHBsYW4gICA9ICRidG4uY2xvc2VzdCggJy5sbG1zLWFjY2Vzcy1wbGFuJyApLFxuXHRcdFx0XHRwbGFuX2lkID0gJHBsYW4uYXR0ciggJ2RhdGEtaWQnICksXG5cdFx0XHRcdHdhcm5pbmcgPSBMTE1TLmwxMG4udHJhbnNsYXRlKCAnQWZ0ZXIgZGVsZXRpbmcgdGhpcyBhY2Nlc3MgcGxhbiwgYW55IHN0dWRlbnRzIHN1YnNjcmliZWQgdG8gdGhpcyBwbGFuIHdpbGwgc3RpbGwgaGF2ZSBhY2Nlc3MgYW5kIHdpbGwgY29udGludWUgdG8gbWFrZSByZWN1cnJpbmcgcGF5bWVudHMgYWNjb3JkaW5nIHRvIHRoZSBhY2Nlc3MgcGxhblxcJ3Mgc2V0dGluZ3MuIElmIHlvdSB3aXNoIHRvIHRlcm1pbmF0ZSB0aGVpciBwbGFucyB5b3UgbXVzdCBkbyBzbyBtYW51YWxseS4gVGhpcyBhY3Rpb24gY2Fubm90IGJlIHJldmVyc2VkLicgKTtcblxuXHRcdFx0Ly8gaWYgdGhlcmUncyBubyBJRCBqdXN0IHJlbW92ZSB0aGUgZWxlbWVudCBmcm9tIHRoZSBET01cblx0XHRcdGlmICggISBwbGFuX2lkICkge1xuXG5cdFx0XHRcdHNlbGYucmVtb3ZlX3BsYW5fZWwoICRwbGFuICk7XG5cblx0XHRcdFx0Ly8gVGhyb3cgYSBjb25maXJtYXRpb24gd2FybmluZ1xuXHRcdFx0fSBlbHNlIGlmICggd2luZG93LmNvbmZpcm0oIHdhcm5pbmcgKSApIHtcblxuXHRcdFx0XHRMTE1TLlNwaW5uZXIuc3RhcnQoICRwbGFuICk7XG5cdFx0XHRcdHdpbmRvdy5MTE1TLkFqYXguY2FsbCgge1xuXHRcdFx0XHRcdGRhdGE6IHtcblx0XHRcdFx0XHRcdGFjdGlvbjogJ2RlbGV0ZV9hY2Nlc3NfcGxhbicsXG5cdFx0XHRcdFx0XHRwbGFuX2lkOiBwbGFuX2lkLFxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oIHIgKSB7XG5cdFx0XHRcdFx0XHRzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0TExNUy5TcGlubmVyLnN0b3AoICRwbGFuICk7XG5cdFx0XHRcdFx0XHR9LCA1NTAgKTtcblx0XHRcdFx0XHRcdGlmICggci5zdWNjZXNzICkge1xuXHRcdFx0XHRcdFx0XHRzZWxmLnJlbW92ZV9wbGFuX2VsKCAkcGxhbiApO1xuXHRcdFx0XHRcdFx0XHRzZWxmLnRyaWdnZXJfdXBkYXRlX2hvb2soKTtcblx0XHRcdFx0XHRcdFx0c2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0c2VsZi51cGRhdGVfcGxhbl9vcmRlcnMoKTtcblx0XHRcdFx0XHRcdFx0fSwgNTAwICk7XG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKCByLm1lc3NhZ2UgKSB7XG5cdFx0XHRcdFx0XHRcdGFsZXJ0KCByLm1lc3NhZ2UgKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fSApO1xuXG5cdFx0XHR9XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogSGFuZGxlIGhpZGluZyAmIHNob3dpbmcgdmFyaW91cyBwaWVjZXMgb2YgYW4gYWNjZXNzIHBsYW4gZm9ybVxuXHRcdCAqIFRoaXMgaXMgYm91bmQgdG8gYW55IGZvcm0gZWxlbWVudCB3aXRoIGEgXCJkYXRhLWNvbnRyb2xsZXItaWRcIiBwcm9wZXJ0eVxuXHRcdCAqXG5cdFx0ICogQHBhcmFtICBvYmogICRlbCAgIGpRdWVyeSBzZWxlY3RvciBmb3IgdGhlIGNoYW5nZWQgZm9ybSBlbGVtZW50XG5cdFx0ICogQHJldHVybiB2b2lkXG5cdFx0ICogQHNpbmNlICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMuY29udHJvbGxlcl9jaGFuZ2UgPSBmdW5jdGlvbiggJGVsICkge1xuXG5cdFx0XHR2YXIgaWQgICAgICAgID0gJGVsLmF0dHIoICdkYXRhLWNvbnRyb2xsZXItaWQnICksXG5cdFx0XHRcdHZhbCAgICAgICA9ICRlbC52YWwoKSxcblx0XHRcdFx0JGZvcm0gICAgID0gJGVsLmNsb3Nlc3QoICcubGxtcy1hY2Nlc3MtcGxhbicgKSxcblx0XHRcdFx0JGNvbnRyb2xzID0gJGZvcm0uZmluZCggJ1tkYXRhLWNvbnRyb2xsZXI9XCInICsgaWQgKyAnXCJdJyApO1xuXG5cdFx0XHRpZiAoICdjaGVja2JveCcgPT09ICRlbC5hdHRyKCAndHlwZScgKSApIHtcblx0XHRcdFx0dmFsID0gKCAkZWwuaXMoICc6Y2hlY2tlZCcgKSApID8gdmFsIDogJ25vJztcblx0XHRcdH1cblxuXHRcdFx0JGNvbnRyb2xzLmVhY2goIGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdHZhciAkYyAgICAgICAgID0gJCggdGhpcyApLFxuXHRcdFx0XHRcdCRlbHMgICAgICAgPSAoICdTRUxFQ1QnID09PSAkY1swXS5ub2RlTmFtZSB8fCAnSU5QVVQnID09PSAkY1swXS5ub2RlTmFtZSB8fCAnVEVYVEFSRUEnID09PSAkY1swXS5ub2RlTmFtZSApID8gJGMgOiAkYy5maW5kKCAnaW5wdXQsIHNlbGVjdCwgdGV4dGFyZWEnICksXG5cdFx0XHRcdFx0ZXF1YWxzICAgICA9ICRjLmF0dHIoICdkYXRhLXZhbHVlLWlzJyApLFxuXHRcdFx0XHRcdG5vdF9lcXVhbHMgPSAkYy5hdHRyKCAnZGF0YS12YWx1ZS1pcy1ub3QnICksXG5cdFx0XHRcdFx0YWN0aW9uLCBvcGVyYXRvcjtcblxuXHRcdFx0XHRpZiAoIHR5cGVvZiBlcXVhbHMgIT09IHR5cGVvZiB1bmRlZmluZWQgJiYgZXF1YWxzICE9PSBmYWxzZSApIHtcblxuXHRcdFx0XHRcdG9wZXJhdG9yID0gJz09JztcblxuXHRcdFx0XHR9IGVsc2UgaWYgKCB0eXBlb2Ygbm90X2VxdWFscyAhPT0gdHlwZW9mIHVuZGVmaW5lZCAmJiBub3RfZXF1YWxzICE9PSBmYWxzZSApIHtcblxuXHRcdFx0XHRcdG9wZXJhdG9yID0gJyE9JztcblxuXHRcdFx0XHR9XG5cblx0XHRcdFx0c3dpdGNoICggb3BlcmF0b3IgKSB7XG5cblx0XHRcdFx0XHRjYXNlICc9PSc6XG5cblx0XHRcdFx0XHRcdGlmICggdmFsID09IGVxdWFscyApIHtcblx0XHRcdFx0XHRcdFx0YWN0aW9uID0gJ3Nob3cnO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0YWN0aW9uID0gJ2hpZGUnO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRjYXNlICchPSc6XG5cblx0XHRcdFx0XHRcdGlmICggdmFsICE9IG5vdF9lcXVhbHMgKSB7XG5cdFx0XHRcdFx0XHRcdGFjdGlvbiA9ICdzaG93Jztcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGFjdGlvbiA9ICdoaWRlJztcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoICdzaG93JyA9PT0gYWN0aW9uICkge1xuXHRcdFx0XHRcdCRjLnNob3coKTtcblx0XHRcdFx0XHQkZWxzLnJlbW92ZUF0dHIoICdkaXNhYmxlZCcgKS50cmlnZ2VyKCAnY2hhbmdlJyApO1xuXHRcdFx0XHR9IGVsc2UgaWYgKCAnaGlkZScgPT09IGFjdGlvbiApIHtcblx0XHRcdFx0XHQkYy5oaWRlKCk7XG5cdFx0XHRcdFx0JGVscy5hdHRyKCAnZGlzYWJsZWQnLCAnZGlzYWJsZWQnICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0fSApO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIFJldHJpZXZlIHRoZSBjdXJyZW50IG51bWJlciBvZiBhY2Nlc3MgcGxhbnMgZm9yIHRoZSBjb3Vyc2UgLyBtZW1iZXJzaGlwIChzYXZlZCBvciB1bnNhdmVkKVxuXHRcdCAqXG5cdFx0ICogQHJldHVybiAgaW50XG5cdFx0ICogQHNpbmNlICAgMy4yOS4wXG5cdFx0ICogQHZlcnNpb24gMy4yOS4wXG5cdFx0ICovXG5cdFx0dGhpcy5nZXRfY3VycmVudF9wbGFuX2NvdW50ID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy4kcGxhbnMuZmluZCggJy5sbG1zLWFjY2Vzcy1wbGFuJyApLmxlbmd0aDtcblx0XHR9XG5cblx0XHQvKipcblx0XHQgKiBSZXRyaWV2ZSBhY2Nlc3MgcGxhbiBkYXRhIGFzIGFuIGFycmF5IG9mIEpTT04gYnVpbHQgZnJvbSB0aGUgZG9tIGVsZW1lbnQgZmllbGQgdmFsdWVzLlxuXHRcdCAqXG5cdFx0ICogQHJldHVybiAgYXJyYXlcblx0XHQgKiBAc2luY2UgICAzLjI5LjBcblx0XHQgKiBAdmVyc2lvbiAzLjI5LjBcblx0XHQgKi9cblx0XHR0aGlzLmdldF9wbGFuc19hcnJheSA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHQvLyBlbnN1cmUgYWxsIGNvbnRlbnQgZWRpdG9ycyBhcmUgc2F2ZWQgcHJvcGVybHkuXG5cdFx0XHR0aW55TUNFLnRyaWdnZXJTYXZlKCk7XG5cblx0XHRcdHZhciBzZWxmICA9IHRoaXMsXG5cdFx0XHRcdGZvcm0gID0gc2VsZi4kcGxhbnMuY2xvc2VzdCggJ2Zvcm0nICkuc2VyaWFsaXplQXJyYXkoKSxcblx0XHRcdFx0cGxhbnMgPSBbXTtcblxuXHRcdFx0Zm9yICggdmFyIGkgPSAwOyBpIDwgZm9ybS5sZW5ndGg7IGkrKyApIHtcblxuXHRcdFx0XHQvLyBTa2lwIG5vbiBwbGFuIGRhdGEgZnJvbSB0aGUgZm9ybS5cblx0XHRcdFx0aWYgKCAtMSA9PT0gZm9ybVsgaSBdLm5hbWUuaW5kZXhPZiggJ19sbG1zX3BsYW5zJyApICkge1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dmFyIGtleXMgID0gZm9ybVsgaSBdLm5hbWUucmVwbGFjZSggJ19sbG1zX3BsYW5zWycsICcnICkuc3BsaXQoICddWycgKSxcblx0XHRcdFx0XHRpbmRleCA9ICgga2V5c1swXSAqIDEgKSAtIDEsXG5cdFx0XHRcdFx0bmFtZSAgPSBrZXlzWzFdLnJlcGxhY2UoICddJywgJycgKSxcblx0XHRcdFx0XHR0eXBlICA9IDMgPT09IGtleXMubGVuZ3RoID8gJ2FycmF5JyA6ICdzaW5nbGUnO1xuXG5cdFx0XHRcdGlmICggISBwbGFuc1sgaW5kZXggXSApIHtcblx0XHRcdFx0XHRwbGFuc1sgaW5kZXggXSA9IHt9O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKCAnYXJyYXknID09PSB0eXBlICkge1xuXG5cdFx0XHRcdFx0aWYgKCAhIHBsYW5zWyBpbmRleCBdWyBuYW1lIF0gKSB7XG5cdFx0XHRcdFx0XHRwbGFuc1sgaW5kZXggXVsgbmFtZSBdID0gW107XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHBsYW5zWyBpbmRleCBdWyBuYW1lIF0ucHVzaCggZm9ybVsgaSBdLnZhbHVlICk7XG5cblx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRcdHBsYW5zWyBpbmRleCBdWyBuYW1lIF0gPSBmb3JtWyBpIF0udmFsdWU7XG5cblx0XHRcdFx0fVxuXG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBwbGFucztcblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBEZXRlcm1pbmUgaWYgdGhlIGFjY2VzcyBwbGFuIGxpbWl0IGhhcyBiZWVuIHJlYWNoZWRcblx0XHQgKlxuXHRcdCAqIEByZXR1cm4gQm9vbGVhblxuXHRcdCAqIEBzaW5jZSAgMy4wLjBcblx0XHQgKiBAdmVyc2lvbiAgMy4yOS4wXG5cdFx0ICovXG5cdFx0dGhpcy5oYXNfcGxhbl9saW1pdF9iZWVuX3JlYWNoZWQgPSBmdW5jdGlvbigpIHtcblxuXHRcdFx0dmFyIGxpbWl0ID0gd2luZG93LmxsbXMucHJvZHVjdC5hY2Nlc3NfcGxhbl9saW1pdDtcblx0XHRcdHJldHVybiB0aGlzLmdldF9jdXJyZW50X3BsYW5fY291bnQoKSA+PSBsaW1pdDtcblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBJbml0aWFsaXplcyBhIG5ldyBwbGFuIGFuZCBhZGRzIGl0IHRvIHRoZSBsaXN0IG9mIHBsYW5zIGluIHRoZSBET01cblx0XHQgKlxuXHRcdCAqIEBzaW5jZSAzLjAuMFxuXHRcdCAqIEBzaW5jZSAzLjMwLjAgSW5pdGlhbGl6ZSBzZWxlY3QyIG9uIGNoZWNrb3V0IHJlZGlyZWN0IGZpZWxkcy5cblx0XHQgKiBAdmVyc2lvbiAzLjMwLjBcblx0XHQgKlxuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICovXG5cdFx0dGhpcy5pbml0X3BsYW4gPSBmdW5jdGlvbigpIHtcblxuXHRcdFx0Ly8gZG9uJ3QgZG8gYW55dGhpbmcgaWYgd2UndmUgcmVhY2hlZCB0aGUgcGxhbiBsaW1pdFxuXHRcdFx0aWYgKCB0aGlzLmhhc19wbGFuX2xpbWl0X2JlZW5fcmVhY2hlZCgpICkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdHZhciAkY2xvbmUgICAgICAgICAgPSAkKCAnI2xsbXMtbmV3LWFjY2Vzcy1wbGFuLW1vZGVsJyApLmNsb25lKClcblx0XHRcdFx0JGV4aXN0aW5nX3BsYW5zID0gJCggJyNsbG1zLWFjY2Vzcy1wbGFucyAubGxtcy1hY2Nlc3MtcGxhbicgKSxcblx0XHRcdFx0JGVkaXRvciAgICAgICAgID0gJGNsb25lLmZpbmQoICcjX2xsbXNfcGxhbnNfY29udGVudF9sbG1zLW5ldy1hY2Nlc3MtcGxhbi1tb2RlbCcgKTtcblxuXHRcdFx0Ly8gcmVtb3ZlIElEIGZyb20gdGhlIGl0ZW1cblx0XHRcdCRjbG9uZS5yZW1vdmVBdHRyKCAnaWQnICk7XG5cblx0XHRcdC8vIGdpdmUgYSB0ZW1wb3JhcnkgaWQgdG8gdGhlIGVkaXRvciBlbGVtZW50XG5cdFx0XHQkZWRpdG9yLnJlbW92ZUF0dHIoICdpZCcgKS5hdHRyKCAnaWQnLCAnX2xsbXNfcGxhbnNfY29udGVudF8nICsgdGhpcy50ZW1wX2lkICk7XG5cdFx0XHR0aGlzLnRlbXBfaWQrKzsgLy8gaW5jcmVtZW50IHRoZSB0ZW1wX2lkIElEIHNvIHdlIGRvbid0IHVzZSBpdCBhZ2FpblxuXG5cdFx0XHQvLyBhY3RpdmF0ZSBhbGwgZWxlbWVudHNcblx0XHRcdCRjbG9uZS5maW5kKCAnc2VsZWN0LCBpbnB1dCwgdGV4dGFyZWEnICkuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdCQoIHRoaXMgKS5yZW1vdmVBdHRyKCAnZGlzYWJsZWQnICk7IC8vIGVuYWJsZWQgdGhlIGZpZWxkXG5cdFx0XHR9ICk7XG5cblx0XHRcdCRjbG9uZS5maW5kKCAnLmxsbXMtYWNjZXNzLXBsYW4tZGF0ZXBpY2tlcicgKS5kYXRlcGlja2VyKCB7XG5cdFx0XHRcdGRhdGVGb3JtYXQ6IFwibW0vZGQveXlcIlxuXHRcdFx0fSApO1xuXG5cdFx0XHQkY2xvbmUuYXBwZW5kVG8oICcjbGxtcy1hY2Nlc3MtcGxhbnMnICk7XG5cblx0XHRcdC8vIHJld3JpdGUgdGhlIG9yZGVyIG9mIGFsbCBlbGVtZW50c1xuXHRcdFx0dGhpcy51cGRhdGVfcGxhbl9vcmRlcnMoKTtcblxuXHRcdFx0JGNsb25lLmZpbmQoICcubGxtcy1jb2xsYXBzaWJsZS1oZWFkZXInICkudHJpZ2dlciggJ2NsaWNrJyApO1xuXG5cdFx0XHQvLyBjaGVjayBpZiB0aGUgbGltaXQgaGFzIGJlZW4gcmVhY2hlZCBhbmQgdG9nZ2xlIHRoZSBidXR0b24gaWYgaXQgaGFzXG5cdFx0XHRpZiAoIHRoaXMuaGFzX3BsYW5fbGltaXRfYmVlbl9yZWFjaGVkKCkgKSB7XG5cdFx0XHRcdHRoaXMudG9nZ2xlX2NyZWF0ZV9idXR0b24oICdkaXNhYmxlJyApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBzZWxlY3QyaWZ5IG1lbWJlcnNoaXAgYXZhaWxhYmlsaXR5IGZpZWxkXG5cdFx0XHR3aW5kb3cubGxtcy5tZXRhYm94ZXMucG9zdF9zZWxlY3QoICRjbG9uZS5maW5kKCAnLmxsbXMtYXZhaWxhYmlsaXR5LXJlc3RyaWN0aW9ucycgKSApO1xuXG5cdFx0XHQvLyBzZWxlY3QyaWZ5IHJlZGlyZWN0aW9uIHBhZ2UgZmllbGRzXG5cdFx0XHR3aW5kb3cubGxtcy5tZXRhYm94ZXMucG9zdF9zZWxlY3QoICRjbG9uZS5maW5kKCAnLmxsbXMtY2hlY2tvdXQtcmVkaXJlY3QtcGFnZScgKSApO1xuXG5cdFx0XHQkY2xvbmUuZmluZCggJ1tkYXRhLWNvbnRyb2xsZXItaWRdJyApLnRyaWdnZXIoICdjaGFuZ2UnICk7XG5cdFx0XHQkKCBkb2N1bWVudCApLnRyaWdnZXIoICdsbG1zLXBsYW4taW5pdCcsICRjbG9uZSApO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIFBlcnNpc3QgYWNjZXNzIHBsYW5zIHRvIHRoZSBEQiBpZiB0aGV5IHBhc3MgdmFsaWRhdGlvblxuXHRcdCAqXG5cdFx0ICogQHNpbmNlIDMuMjkuMFxuXHRcdCAqIEBzaW5jZSAzLjMwLjMgRml4ZWQgdHlwbyBpbiBlcnJvciBtZXNzYWdlLlxuXHRcdCAqXG5cdFx0ICogQHJldHVybiB2b2lkXG5cdFx0ICovXG5cdFx0dGhpcy5zYXZlX3BsYW5zID0gZnVuY3Rpb24oKSB7XG5cblx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0c2VsZi4kcGxhbnMuZmluZCggJy5sbG1zLWFjY2Vzcy1wbGFuJyApLm5vdCggJyNsbG1zLW5ldy1hY2Nlc3MtcGxhbi1tb2RlbCcgKS5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0JCggdGhpcyApLnRyaWdnZXIoICdsbG1zLXZhbGlkYXRlLXBsYW4nICk7XG5cdFx0XHR9ICk7XG5cblx0XHRcdGlmICggc2VsZi4kcGxhbnMuZmluZCggJy4nICsgc2VsZi52YWxpZGF0aW9uX2NsYXNzICkubGVuZ3RoICkge1xuXHRcdFx0XHRzZWxmLiRwbGFucy5maW5kKCAnLmxsbXMtYWNjZXNzLXBsYW4uJyArIHNlbGYudmFsaWRhdGlvbl9jbGFzcyApLm5vdCggJy5vcGVuZWQnICkuZmlyc3QoKS5maW5kKCAnLmxsbXMtY29sbGFwc2libGUtaGVhZGVyJyApLnRyaWdnZXIoICdjbGljaycgKTtcblx0XHRcdFx0JCggZG9jdW1lbnQgKS50cmlnZ2VyKCAnbGxtcy1hY2Nlc3MtcGxhbi12YWxpZGF0aW9uLWVycm9ycycgKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRMTE1TLlNwaW5uZXIuc3RhcnQoIHNlbGYuJHBsYW5zICk7XG5cdFx0XHRzZWxmLiRzYXZlLmF0dHIoICdkaXNhYmxlZCcsICdkaXNhYmxlZCcgKTtcblx0XHRcdHdpbmRvdy5MTE1TLkFqYXguY2FsbCgge1xuXHRcdFx0XHRkYXRhOiB7XG5cdFx0XHRcdFx0YWN0aW9uOiAnbGxtc191cGRhdGVfYWNjZXNzX3BsYW5zJyxcblx0XHRcdFx0XHRwbGFuczogc2VsZi5nZXRfcGxhbnNfYXJyYXkoKSxcblx0XHRcdFx0fSxcblx0XHRcdFx0Y29tcGxldGU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdExMTVMuU3Bpbm5lci5zdG9wKCBzZWxmLiRwbGFucyApO1xuXHRcdFx0XHRcdHNlbGYuJHNhdmUucmVtb3ZlQXR0ciggJ2Rpc2FibGVkJyApO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oIGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93biApIHtcblx0XHRcdFx0XHRjb25zb2xlLmVycm9yKCAnbGxtcyBhY2Nlc3MgcGxhbiBzYXZlIGVycm9yIGVuY291bnRlcmQ6JywganFYSFIgKTtcblx0XHRcdFx0XHRhbGVydCggTExNUy5sMTBuLnRyYW5zbGF0ZSggJ0FuIGVycm9yIHdhcyBlbmNvdW50ZXJlZCBkdXJpbmcgdGhlIHNhdmUgYXR0ZW1wdC4gUGxlYXNlIHRyeSBhZ2Fpbi4nICkgKyAnIFsnICsgdGV4dFN0YXR1cyArICc6ICcgKyBlcnJvclRocm93biArICddJyApO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiggcmVzICkge1xuXG5cdFx0XHRcdFx0aWYgKCAhIHJlcy5zdWNjZXNzICYmIHJlcy5jb2RlICYmICdlcnJvcicgPT09IHJlcy5jb2RlICkge1xuXHRcdFx0XHRcdFx0YWxlcnQoIHJlcy5tZXNzYWdlICk7XG5cdFx0XHRcdFx0fSBlbHNlIGlmICggcmVzLmRhdGEgJiYgcmVzLmRhdGEuaHRtbCApIHtcblxuXHRcdFx0XHRcdFx0Ly8gcmVwbGFjZSB0aGUgbWV0YWJveCB3aXRoIHVwZGF0ZWQgZGF0YSBmcm9tIHRoZSBzZXJ2ZXIuXG5cdFx0XHRcdFx0XHQkKCAnI2xsbXMtcHJvZHVjdC1vcHRpb25zLWFjY2Vzcy1wbGFucycgKS5yZXBsYWNlV2l0aCggcmVzLmRhdGEuaHRtbCApO1xuXG5cdFx0XHRcdFx0XHQvLyByZWluaXQuXG5cdFx0XHRcdFx0XHRzZWxmLmluaXQoIHRydWUgKTtcblx0XHRcdFx0XHRcdHdpbmRvdy5sbG1zLm1ldGFib3hlcy5pbml0KCk7XG5cdFx0XHRcdFx0XHRzZWxmLnVwZGF0ZV9wbGFuX29yZGVycygpO1xuXG5cdFx0XHRcdFx0XHQvLyBub3RpZnkgdGhlIGJsb2NrIGVkaXRvclxuXHRcdFx0XHRcdFx0c2VsZi50cmlnZ2VyX3VwZGF0ZV9ob29rKCk7XG5cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fSxcblxuXHRcdFx0fSApO1xuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBUb2dnbGUgdGhlIHN0YXR1cyBvZiBhIGJ1dHRvblxuXHRcdCAqXG5cdFx0ICogQHBhcmFtICAgT2JqZWN0ICAkYnRuICAgalF1ZXJ5IHNlbGVjdG9yIG9mIGEgYnV0dG9uIGVsZW1lbnRcblx0XHQgKiBAcGFyYW0gIHN0cmluZyBzdGF0dXMgZW5hYmxlIG9yIGRpc2FibGVcblx0XHQgKiBAcmV0dXJuICB2b2lkXG5cdFx0ICogQHNpbmNlICAgMy4yOS4wXG5cdFx0ICogQHZlcnNpb24gMy4yOS4wXG5cdFx0ICovXG5cdFx0dGhpcy50b2dnbGVfYnV0dG9uID0gZnVuY3Rpb24oICRidG4sIHN0YXR1cyApIHtcblxuXHRcdFx0aWYgKCAnZGlzYWJsZScgPT09IHN0YXR1cyApIHtcblx0XHRcdFx0JGJ0bi5hdHRyKCAnZGlzYWJsZWQnLCAnZGlzYWJsZWQnICk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQkYnRuLnJlbW92ZUF0dHIoICdkaXNhYmxlZCcgKTtcblx0XHRcdH1cblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBDb250cm9sIHRoZSBzdGF0dXMgb2YgdGhlIFwiTmV3IEFjY2VzcyBQbGFuXCIgQnV0dG9uXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gIHN0cmluZyBzdGF0dXMgZW5hYmxlIG9yIGRpc2FibGVcblx0XHQgKiBAcmV0dXJuIHZvaWRcblx0XHQgKiBAc2luY2UgIDMuMC4wXG5cdFx0ICogQHNpbmNlICAzLjI5LjBcblx0XHQgKi9cblx0XHR0aGlzLnRvZ2dsZV9jcmVhdGVfYnV0dG9uID0gZnVuY3Rpb24oIHN0YXR1cyApIHtcblx0XHRcdHRoaXMudG9nZ2xlX2J1dHRvbiggJCggJyNsbG1zLW5ldy1hY2Nlc3MtcGxhbicgKSwgc3RhdHVzICk7XG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIENvbnRyb2wgdGhlIHN0YXR1cyBvZiB0aGUgXCJTYXZlIEFjY2VzcyBQbGFuc1wiIEJ1dHRvblxuXHRcdCAqXG5cdFx0ICogQHBhcmFtICBzdHJpbmcgc3RhdHVzIGVuYWJsZSBvciBkaXNhYmxlXG5cdFx0ICogQHJldHVybiB2b2lkXG5cdFx0ICogQHNpbmNlICAzLjAuMFxuXHRcdCAqIEBzaW5jZSAgMy4yOS4wXG5cdFx0ICovXG5cdFx0dGhpcy50b2dnbGVfc2F2ZV9idXR0b24gPSBmdW5jdGlvbiggc3RhdHVzICkge1xuXHRcdFx0dGhpcy50b2dnbGVfYnV0dG9uKCB0aGlzLiRzYXZlLCBzdGF0dXMgKTtcblx0XHR9XG5cblx0XHQvKipcblx0XHQgKiBWaXN1YWxseSBoaWRlIGFuZCB0aGVuIHBoeXNpY2FsbHkgcmVtb3ZlIGEgcGxhbiBlbGVtZW50IGZyb20gdGhlIERPTVxuXHRcdCAqIEFkZGl0aW9uYWxseSBkZXRlcm1pbmVzIGlmIHRoZSBOZXcgUGxhbiBCdXR0b24gc2hvdWxkIGJlIHJlLWVuYWJsZWRcblx0XHQgKiBhZnRlciBkZWxldGlvblxuXHRcdCAqXG5cdFx0ICogQHBhcmFtICBvYmogICAkcGxhbiBqUXVlcnkgc2VsZWN0b3Igb2YgdGhlIHBsYW4gZWxlbWVudFxuXHRcdCAqIEByZXR1cm4gdm9pZFxuXHRcdCAqIEBzaW5jZSAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uIDMuMjkuMFxuXHRcdCAqL1xuXHRcdHRoaXMucmVtb3ZlX3BsYW5fZWwgPSBmdW5jdGlvbiggJHBsYW4gKSB7XG5cblx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0Ly8gZmFkZSBvdXQgbmljZWx5XG5cdFx0XHQkcGxhbi5mYWRlT3V0KCA0MDAgKTtcblxuXHRcdFx0Ly8gcmVtb3ZlIGZyb20gZG9tIGFmdGVyIGl0J3MgaGlkZGVuIHZpc3VhbGx5XG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdCRwbGFuLnJlbW92ZSgpO1xuXG5cdFx0XHRcdC8vIGNoZWNrIGlmIHdlIG5lZWQgdG8gcmVlbmFibGUgdGhlIGNyZWF0ZSBidXR0b24gYW5kIGhpZGUgdGhlIG1lc3NhZ2Vcblx0XHRcdFx0aWYgKCAhIHNlbGYuaGFzX3BsYW5fbGltaXRfYmVlbl9yZWFjaGVkKCkgKSB7XG5cdFx0XHRcdFx0c2VsZi50b2dnbGVfY3JlYXRlX2J1dHRvbiggJ2VuYWJsZScgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICggMCA9PT0gc2VsZi5nZXRfY3VycmVudF9wbGFuX2NvdW50KCkgKSB7XG5cdFx0XHRcdFx0c2VsZi50b2dnbGVfc2F2ZV9idXR0b24oICdkaXNhYmxlJyApO1xuXHRcdFx0XHR9XG5cblx0XHRcdH0sIDQ1MCApO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIFRyaWdnZXIgV1AgQmxvY2sgRWRpdG9yIGhvb2sgc28gdGhlIHByaWNpbmcgdGFibGUgYmxvY2sgY2FuIGJlIHJlLXJlbmRlcmVkIHdpdGggbmV3IHBsYW4gaW5mb3JtYXRpb24uXG5cdFx0ICpcblx0XHQgKiBAcmV0dXJuICB2b2lkXG5cdFx0ICogQHNpbmNlICAgMy4yOS4wXG5cdFx0ICogQHZlcnNpb24gMy4yOS4wXG5cdFx0ICovXG5cdFx0dGhpcy50cmlnZ2VyX3VwZGF0ZV9ob29rID0gZnVuY3Rpb24oKSB7XG5cblx0XHRcdCQoIGRvY3VtZW50ICkudHJpZ2dlciggJ2xsbXMtYWNjZXNzLXBsYW5zLXVwZGF0ZWQnICk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogUmVvcmRlciB0aGUgYXJyYXkgaW5kZXhlcyBhbmQgdGhlIG1lbnUgb3JkZXIgaGlkZGVuIGlucHV0cy5cblx0XHQgKiBDYWxsZWQgYnkgalF1ZXJ5IFVJIFNvcnRhYmxlIG9uIHNvcnQgY29tcGxldGlvbi5cblx0XHQgKiBBbHNvIGNhbGxlZCBhZnRlciBhZGRpbmcgYSBuZXcgcGxhbiB0byB0aGUgRE9NIHNvIHRoZSBuZXdlc3QgaXRlbSBpcyBhbHdheXNcblx0XHQgKiBwZXJzaXN0ZWQgYXMgdGhlIGxhc3QgaW4gdGhlIGRhdGFiYXNlIGlmIG5vIFVYIHJlb3JkZXJzIHRoZSBpdGVtLlxuXHRcdCAqXG5cdFx0ICogQHNpbmNlIDMuMC4wXG5cdFx0ICogQHNpbmNlIDMuMzYuMyBGaXhlZCBjb25mbGljdHMgd2l0aCB0aGUgY2xhc3NpYyBlZGl0b3IgYmxvY2suXG5cdFx0ICpcblx0XHQgKiBAcmV0dXJuIHZvaWRcblx0XHQgKi9cblx0XHR0aGlzLnVwZGF0ZV9wbGFuX29yZGVycyA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHQkKCAnI2xsbXMtYWNjZXNzLXBsYW5zIC5sbG1zLWFjY2Vzcy1wbGFuJyApLmVhY2goIGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdHZhciAkcCAgICAgICAgPSAkKCB0aGlzICksXG5cdFx0XHRcdFx0JG9yZGVyICAgID0gJHAuZmluZCggJy5wbGFuLW9yZGVyJyApLFxuXHRcdFx0XHRcdCRlZGl0b3IgICA9ICRwLmZpbmQoICd0ZXh0YXJlYVtpZF49XCJfbGxtc19wbGFuc19jb250ZW50X1wiXScgKSxcblx0XHRcdFx0XHRlZGl0b3JfaWQgPSAkZWRpdG9yLmF0dHIoICdpZCcgKSxcblx0XHRcdFx0XHRvcmlnICAgICAgPSAkb3JkZXIudmFsKCkgKiAxLFxuXHRcdFx0XHRcdGN1cnIgICAgICA9ICRwLmluZGV4KCksXG5cdFx0XHRcdFx0ZWRpdG9yICAgID0gdGlueU1DRS5FZGl0b3JNYW5hZ2VyLmdldChlZGl0b3JfaWQpLFxuXHRcdFx0XHRcdGVzZXR0aW5ncyA9IGVkaXRvciA/IGVkaXRvci5zZXR0aW5ncyA6IHRpbnlNQ0UuRWRpdG9yTWFuYWdlci5zZXR0aW5ncztcblxuXHRcdFx0XHQvLyBtYWtlIHN1cmUgdGhlIGVkaXRvciBzZXR0aW5ncyBoYXZlIHRoZSByaWdodCBzZWxlY3Rvci5cblx0XHRcdFx0ZXNldHRpbmdzLnNlbGVjdG9yID0gJyMnICsgZWRpdG9yX2lkO1xuXG5cdFx0XHRcdC8vIGRlLWluaXQgdGlueU1DRSBmcm9tIHRoZSBlZGl0b3IuXG5cdFx0XHRcdHRpbnlNQ0UuRWRpdG9yTWFuYWdlci5leGVjQ29tbWFuZCggJ21jZVJlbW92ZUVkaXRvcicsIHRydWUsIGVkaXRvcl9pZCApO1xuXG5cdFx0XHRcdC8vIHVwZGF0ZSB0aGUgb3JkZXIgb2YgZWFjaCBmaWVsZCBpbiB0aGUgcGxhbi5cblx0XHRcdFx0JHAuZmluZCggJ3NlbGVjdCwgaW5wdXQsIHRleHRhcmVhJyApLmVhY2goIGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdFx0dmFyIG5hbWUgPSAkKCB0aGlzICkuYXR0ciggJ25hbWUnICk7XG5cdFx0XHRcdFx0aWYgKCBuYW1lICkge1xuXHRcdFx0XHRcdFx0JCggdGhpcyApLmF0dHIoICduYW1lJywgbmFtZS5yZXBsYWNlKCBvcmlnLCBjdXJyICkgKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fSApO1xuXG5cdFx0XHRcdC8vIHJlLWluaXQgdGlueU1DRSBvbiB0aGUgZWRpdG9yLlxuXHRcdFx0XHQvLyBXZSB1c2VkOlx0dGlueU1DRS5FZGl0b3JNYW5hZ2VyLmV4ZWNDb21tYW5kKCAnbWNlQWRkRWRpdG9yJywgdHJ1ZSwgZWRpdG9yX2lkICk7XG5cdFx0XHRcdC8vIGJ1dCBpdCB0dXJuZWQgb3V0IHRvIGNyZWF0ZSBjb25mbGljdHMgd2l0aCB0aGUgQ2xhc3NpYyBFZGl0b3IgYmxvY2suXG5cdFx0XHRcdHRpbnlNQ0UuRWRpdG9yTWFuYWdlci5pbml0KCBlc2V0dGluZ3MgKTtcblxuXHRcdFx0XHQkb3JkZXIudmFsKCBjdXJyICk7XG5cblx0XHRcdH0gKTtcblxuXHRcdH07XG5cblx0XHQvLyBnb1xuXHRcdHRoaXMuaW5pdCgpO1xuXG5cdH07XG5cblx0dmFyIGEgPSBuZXcgd2luZG93LmxsbXMubWV0YWJveF9wcm9kdWN0KCk7XG5cbn0gKSggalF1ZXJ5ICk7XG4iXX0=
